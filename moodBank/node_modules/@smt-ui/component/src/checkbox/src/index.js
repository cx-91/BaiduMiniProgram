/**
 * @file 多选项组件
 * @author zhangwen22(zhangwen22@baidu.com)
 */
import {upx2rpx} from '../../common/utils/px';
import {
    COLOR_TIPS,
    COLOR_WHITE
} from '../../common/style/color';
/* global Component */
Component({
    externalClasses: ['check-box-class'],
    properties: {
        // 传入value，如果选中则为true
        value: {
            type: Boolean,
            value: false
        },
        // 是否选中
        checked: {
            type: Boolean,
            value: false
        },
        // 是否为不可点击
        disabled: {
            type: Boolean,
            value: false
        },
        // option中的key
        optionKey: {
            type: String,
            value: 'name'
        },
        // checkbox内联样式
        itemStyle: {
            type: Object,
            value: {}
        },
        // icon样式
        iconStyle: {
            type: Object,
            value: {}
        },
        // 是否为两列分布
        column: {
            type: Number,
            value: 1
        },
        // 选中时的文字颜色
        activeTextColor: {
            type: String,
            value: COLOR_TIPS
        },
        // 选中时的icon颜色
        activeIconColor: {
            type: String,
            value: COLOR_TIPS
        },
        // 选中时的背景颜色
        activeBgColor: {
            type: String,
            value: ''
        }
    },
    data: {
        // 初始化icon样式
        iconStyle: {}
    },
    created() {
        this.updateIcon();
    },
    /**
     * 点击选择多选
     *
     * @param {Object} event
     */
    clkHdl(event) {
        const value = event.currentTarget.dataset.value;
        const {checked, disabled} = this.data;
        if (disabled) {
            return;
        }
        this.setData({
            checked: !checked
        }, () => {
            this.updateIcon();
            this.triggerEvent('change', {
                val: value,
                checked: this.data.checked
            });
        });
    },

    /**
     * 更新icon以及文字背景样式
     */
    updateIcon() {
        let {
            checked,
            activeTextColor,
            activeIconColor,
            activeBgColor
        } = this.data;
        this.setData({
            iconStyle: {
                name: 'checked-l',
                size: upx2rpx(50) + 'rpx',
                color: [activeIconColor, COLOR_WHITE]
            },
            itemStyle: {
                ...this.data.itemStyle,
                'color': checked ? activeTextColor : '',
                'background-color': checked ? activeBgColor : ''
            }
        });
    }
});
